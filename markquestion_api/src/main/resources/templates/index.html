<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <div th:include="common/js_css :: js_css"></div>
</head>
<body>

<div class="ui grid">
    <!--顶部导航栏 目前的计划是做成横向的导航栏-->
    <div class="row" th:include="common/nav :: nav">
    </div>

    <!--占位-->
    <div class="two wide column"></div>
    <!--题解主体-->
    <div class="ten wide column">

        <div class="row">
<!--            &lt;!&ndash;搜索框&ndash;&gt;-->
<!--            <div class="ui icon input">-->
<!--                <div style="margin: auto 0px !important;"><i class="icon iconfont">&#xe6ac;</i></div>-->
<!--                <input id="search" name="search" type="text" placeholder="根据名称搜索...">-->
<!--            </div>-->
<!--            &nbsp;&nbsp;&nbsp;-->

<!--            &lt;!&ndash;下拉菜单&ndash;&gt;-->
<!--            题目来源：<select id="platform" class="ui dropdown">-->
<!--            <option value="all">all</option>-->
<!--            <option th:each="platform : ${platforms}" th:text="${platform.platform}">newCoder</option>-->
<!--        </select>-->
<!--            &nbsp;&nbsp;&nbsp;-->

<!--            标签：<select id="tag" class="ui dropdown">-->
<!--            <option value="all">all</option>-->

<!--            <option th:each="questionTag : ${questionTags}" th:text="${questionTag.tagName}">java</option>-->
<!--        </select>-->

        </div>
<!--        题解总数: <span id="questionNum" th:text="${questionNum}"></span>-->
        <span hidden id="questionNum" th:text="${questionNum}"></span>
        <table class="ui single line table">
            <thead>
            <tr>
                <th>题号</th>
                <th>题目名称</th>
                <th>来源</th>
                <th>作者</th>
                <th>标签</th>
                <th>阅读量</th>
            </tr>
            </thead>
            <tbody id="body">
            <tr th:each="question : ${questions}">
                <td th:text="${question.id}">1</td>
                <td><a th:text="${question.questionName}" th:href="@{/question/showQuestion?id=}+${question.id}">题目一</a>
                </td>
                <td th:text="${question.questionFrom}">leetcode</td>
                <td th:text="${question.author}">作者一</td>
                <td><a th:text="${question.tag}" class="ui teal tag label">java</a></td>
                <td th:text="${question.watch}">32854</td>
            </tr>
            </tbody>
        </table>
        <!--分页按钮 一页放15个-->
        <div>
            <button id="lastPage" class="ui button">上一页</button>
            &nbsp;&nbsp;当前页数: <span id="pageNum">1</span> &nbsp;&nbsp;
            <button id="nextPage" class="ui button">下一页</button>
        </div>
    </div>

    <!--侧面比赛日程栏-->
    <div class="three wide column">
        <!-- 占位-->
        <div class="row">
            <h1>&nbsp;</h1>
        </div>

        <div style="margin:0px auto;height: 35px;background-color: dodgerblue">
            <h2>比赛日程表</h2>
        </div>
        <div class="ui inverted segment" style="margin-top: 0px !important;">
            <div class="ui inverted relaxed divided list">

                <div class="item" th:each="contest : ${contests}">
                    <div class="content">
                        <div><a style="font-size: large" class="header" th:text="${contest.platform}"
                                th:href="${contest.link}">newCoder比赛</a></div>
                        <br>
                        <span th:text="${#dates.format(contest.contestTime,'yyyy-MM-dd HH:mm:ss')}">2022年6月7日 13:13:13</span>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!--底部-->
    <div style="margin: 20px auto;font-size: large" th:include="common/footer :: footer"></div>
</div>


<script>
    //使用ajax实现异步刷新，执行搜索框，题目来源选择框，标签框

    //由于和分页功能冲突，所以暂时关闭
    // //搜索框
    // $("#search").keyup(function () {
    //     let searchEl = document.getElementById("search").value;
    //     //将分页按钮部分的页数调整到第一页
    //     $("#pageNum").text(1);
    //     if (searchEl !== "" || searchEl !== null) {
    //         $("#tag").val($("#tag option:nth-child(1)").text())
    //         $("#platform").val($("#platform option:nth-child(1)").text())
    //
    //         let url = "/question/getQuestionBySearch?search=" + searchEl;
    //         $.ajax({
    //             url: url,
    //             type: "GET",
    //             success: function (args) {//成功的回调函数
    //                 let questions = JSON.parse(args);
    //                 let body = $("#body");
    //                 //先清空之前的内容
    //                 body.empty();
    //
    //                 //修改题解总数统计
    //                 $("#questionNum").text(questions.length);
    //
    //                 for (let index in questions) {
    //                     let question = questions[index];
    //
    //                     let tr = document.createElement("tr");
    //
    //                     let id = document.createElement("td");
    //                     id.append(document.createTextNode(question.id));
    //                     tr.append(id);
    //
    //                     let questionName = document.createElement("td");
    //                     let a1 = document.createElement("a");
    //                     a1.append(document.createTextNode(question.questionName));
    //                     a1.setAttribute("href", "/question/showQuestion?id=" + question.id);
    //                     questionName.append(a1);
    //                     tr.append(questionName);
    //
    //                     let questionFrom = document.createElement("td");
    //                     questionFrom.append(document.createTextNode(question.questionFrom));
    //                     tr.append(questionFrom);
    //
    //                     let author = document.createElement("td");
    //                     author.append(document.createTextNode(question.author));
    //                     tr.append(author);
    //
    //                     let tag = document.createElement("td");
    //                     let a2 = document.createElement("a");
    //                     a2.append(document.createTextNode(question.tag))
    //                     a2.setAttribute("class", "ui teal tag label");
    //                     tag.append(a2);
    //                     tr.append(tag);
    //
    //                     let watch = document.createElement("td");
    //                     watch.append(document.createTextNode(question.watch));
    //                     tr.append(watch);
    //
    //                     body.append(tr);
    //
    //                 }
    //             },
    //             error: function () {//失败的回调函数
    //
    //             }
    //         })
    //     } else {
    //         $("#tag").val($("#tag option:nth-child(1)").text())
    //         $("#platform").val($("#platform option:nth-child(1)").text())
    //
    //         let url = "/question/getAllQuestion";
    //         $.ajax({
    //             url: url,
    //             type: "GET",
    //             success: function (args) {//成功的回调函数
    //                 let questions = JSON.parse(args);
    //                 let body = $("#body");
    //                 body.empty();
    //
    //                 //修改题解总数统计
    //                 $("#questionNum").text(questions.length);
    //
    //                 for (let index in questions) {
    //                     let question = questions[index];
    //
    //                     let tr = document.createElement("tr");
    //
    //                     let id = document.createElement("td");
    //                     id.append(document.createTextNode(question.id));
    //                     tr.append(id);
    //
    //                     let questionName = document.createElement("td");
    //                     let a1 = document.createElement("a");
    //                     a1.append(document.createTextNode(question.questionName));
    //                     a1.setAttribute("href", "/question/showQuestion?id=" + question.id);
    //                     questionName.append(a1);
    //                     tr.append(questionName);
    //
    //                     let questionFrom = document.createElement("td");
    //                     questionFrom.append(document.createTextNode(question.questionFrom));
    //                     tr.append(questionFrom);
    //
    //                     let author = document.createElement("td");
    //                     author.append(document.createTextNode(question.author));
    //                     tr.append(author);
    //
    //                     let tag = document.createElement("td");
    //                     let a2 = document.createElement("a");
    //                     a2.append(document.createTextNode(question.tag))
    //                     a2.setAttribute("class", "ui teal tag label");
    //                     tag.append(a2);
    //                     tr.append(tag);
    //
    //                     let watch = document.createElement("td");
    //                     watch.append(document.createTextNode(question.watch));
    //                     tr.append(watch);
    //
    //                     body.append(tr);
    //
    //                 }
    //             },
    //             error: function () {//失败的回调函数
    //
    //             }
    //         })
    //     }
    // })
    //
    // //题目来源选择框
    // $("#platform").change(function () {
    //     //由于只能让其中一个选择框生效所以这里自动将标签选择框置为all
    //     $("#tag").val($("#tag option:nth-child(1)").text())
    //
    //     //让搜索框的内容置空
    //     $("#search").val("")
    //
    //     //将分页按钮部分的页数调整到第一页
    //     $("#pageNum").text(1);
    //
    //     let platform = $("#platform").find("option:selected").text();
    //     if (platform !== "all") {
    //         let url = "/question/getQuestionByPlatform?platform=" + platform;
    //         $.ajax({
    //             url: url,
    //             type: "GET",
    //             success: function (args) {//成功的回调函数
    //                 let questions = JSON.parse(args);
    //                 let body = $("#body");
    //                 //先清空之前的内容
    //                 body.empty();
    //
    //                 //修改题解总数统计
    //                 $("#questionNum").text(questions.length);
    //
    //                 for (let index in questions) {
    //                     let question = questions[index];
    //
    //                     let tr = document.createElement("tr");
    //
    //                     let id = document.createElement("td");
    //                     id.append(document.createTextNode(question.id));
    //                     tr.append(id);
    //
    //                     let questionName = document.createElement("td");
    //                     let a1 = document.createElement("a");
    //                     a1.append(document.createTextNode(question.questionName));
    //                     a1.setAttribute("href", "/question/showQuestion?id=" + question.id);
    //                     questionName.append(a1);
    //                     tr.append(questionName);
    //
    //                     let questionFrom = document.createElement("td");
    //                     questionFrom.append(document.createTextNode(question.questionFrom));
    //                     tr.append(questionFrom);
    //
    //                     let author = document.createElement("td");
    //                     author.append(document.createTextNode(question.author));
    //                     tr.append(author);
    //
    //                     let tag = document.createElement("td");
    //                     let a2 = document.createElement("a");
    //                     a2.append(document.createTextNode(question.tag))
    //                     a2.setAttribute("class", "ui teal tag label");
    //                     tag.append(a2);
    //                     tr.append(tag);
    //
    //                     let watch = document.createElement("td");
    //                     watch.append(document.createTextNode(question.watch));
    //                     tr.append(watch);
    //
    //                     body.append(tr);
    //
    //                 }
    //             },
    //             error: function () {//失败的回调函数
    //
    //             }
    //         })
    //     } else {
    //         let url = "/question/getAllQuestion";
    //         $.ajax({
    //             url: url,
    //             type: "GET",
    //             success: function (args) {//成功的回调函数
    //                 let questions = JSON.parse(args);
    //                 let body = $("#body");
    //                 body.empty();
    //
    //                 //修改题解总数统计
    //                 $("#questionNum").text(questions.length);
    //
    //                 for (let index in questions) {
    //                     let question = questions[index];
    //
    //                     let tr = document.createElement("tr");
    //
    //                     let id = document.createElement("td");
    //                     id.append(document.createTextNode(question.id));
    //                     tr.append(id);
    //
    //                     let questionName = document.createElement("td");
    //                     let a1 = document.createElement("a");
    //                     a1.append(document.createTextNode(question.questionName));
    //                     a1.setAttribute("href", "/question/showQuestion?id=" + question.id);
    //                     questionName.append(a1);
    //                     tr.append(questionName);
    //
    //                     let questionFrom = document.createElement("td");
    //                     questionFrom.append(document.createTextNode(question.questionFrom));
    //                     tr.append(questionFrom);
    //
    //                     let author = document.createElement("td");
    //                     author.append(document.createTextNode(question.author));
    //                     tr.append(author);
    //
    //                     let tag = document.createElement("td");
    //                     let a2 = document.createElement("a");
    //                     a2.append(document.createTextNode(question.tag))
    //                     a2.setAttribute("class", "ui teal tag label");
    //                     tag.append(a2);
    //                     tr.append(tag);
    //
    //                     let watch = document.createElement("td");
    //                     watch.append(document.createTextNode(question.watch));
    //                     tr.append(watch);
    //
    //                     body.append(tr);
    //
    //                 }
    //             },
    //             error: function () {//失败的回调函数
    //
    //             }
    //         })
    //     }
    //
    // })
    //
    // //标签选择框
    // $("#tag").change(function () {
    //     //由于只能让其中一个选择框生效所以这里自动将题目来源选择框置为all
    //     $("#platform").val($("#platform option:nth-child(1)").text())
    //     //让搜索框的内容置空
    //     $("#search").val("")
    //     //将分页按钮部分的页数调整到第一页
    //     $("#pageNum").text(1);
    //     let tag = $("#tag").find("option:selected").text();
    //     if (tag !== "all") {
    //         let url = "/question/getQuestionByTag?tag=" + tag;
    //         $.ajax({
    //             url: url,
    //             type: "GET",
    //             success: function (args) {//成功的回调函数
    //                 let questions = JSON.parse(args);
    //                 let body = $("#body");
    //                 body.empty();
    //
    //                 //修改题解总数统计
    //                 $("#questionNum").text(questions.length);
    //                 for (let index in questions) {
    //                     let question = questions[index];
    //
    //                     let tr = document.createElement("tr");
    //
    //                     let id = document.createElement("td");
    //                     id.append(document.createTextNode(question.id));
    //                     tr.append(id);
    //
    //                     let questionName = document.createElement("td");
    //                     let a1 = document.createElement("a");
    //                     a1.append(document.createTextNode(question.questionName));
    //                     a1.setAttribute("href", "/question/showQuestion?id=" + question.id);
    //                     questionName.append(a1);
    //                     tr.append(questionName);
    //
    //                     let questionFrom = document.createElement("td");
    //                     questionFrom.append(document.createTextNode(question.questionFrom));
    //                     tr.append(questionFrom);
    //
    //                     let author = document.createElement("td");
    //                     author.append(document.createTextNode(question.author));
    //                     tr.append(author);
    //
    //                     let tag = document.createElement("td");
    //                     let a2 = document.createElement("a");
    //                     a2.append(document.createTextNode(question.tag))
    //                     a2.setAttribute("class", "ui teal tag label");
    //                     tag.append(a2);
    //                     tr.append(tag);
    //
    //                     let watch = document.createElement("td");
    //                     watch.append(document.createTextNode(question.watch));
    //                     tr.append(watch);
    //
    //                     body.append(tr);
    //                 }
    //             },
    //             error: function () {//失败的回调函数
    //
    //             }
    //         })
    //     } else {
    //         let url = "/question/getAllQuestion";
    //         $.ajax({
    //             url: url,
    //             type: "GET",
    //             success: function (args) {//成功的回调函数
    //                 let questions = JSON.parse(args);
    //                 let body = $("#body");
    //                 body.empty();
    //
    //                 //修改题解总数统计
    //                 $("#questionNum").text(questions.length);
    //                 for (let index in questions) {
    //                     let question = questions[index];
    //
    //                     let tr = document.createElement("tr");
    //
    //                     let id = document.createElement("td");
    //                     id.append(document.createTextNode(question.id));
    //                     tr.append(id);
    //
    //                     let questionName = document.createElement("td");
    //                     let a1 = document.createElement("a");
    //                     a1.append(document.createTextNode(question.questionName));
    //                     a1.setAttribute("href", "/question/showQuestion?id=" + question.id);
    //                     questionName.append(a1);
    //                     tr.append(questionName);
    //
    //                     let questionFrom = document.createElement("td");
    //                     questionFrom.append(document.createTextNode(question.questionFrom));
    //                     tr.append(questionFrom);
    //
    //                     let author = document.createElement("td");
    //                     author.append(document.createTextNode(question.author));
    //                     tr.append(author);
    //
    //                     let tag = document.createElement("td");
    //                     let a2 = document.createElement("a");
    //                     a2.append(document.createTextNode(question.tag))
    //                     a2.setAttribute("class", "ui teal tag label");
    //                     tag.append(a2);
    //                     tr.append(tag);
    //
    //                     let watch = document.createElement("td");
    //                     watch.append(document.createTextNode(question.watch));
    //                     tr.append(watch);
    //
    //                     body.append(tr);
    //
    //                 }
    //             },
    //             error: function () {//失败的回调函数
    //
    //             }
    //         })
    //     }
    //
    // })

    //将导航栏中的首页标签选中
    $(function () {
        $("#index").attr("class", "item active");
    })

    //分页的JS  一页放15个
    //上一页的按钮
    $("#lastPage").click(function () {

        let pageNum = $("#pageNum").text();
        if (pageNum > 1) {
            pageNum--;
            $("#pageNum").text(pageNum);
            $.ajax({
                url: "/question/getPageAllQuestion?page=" + pageNum,
                type: "GET",
                success: function (args) {
                    console.log(args)
                    let questions = JSON.parse(args);
                    let body = $("#body");
                    body.empty();
                    for (let index in questions) {
                        let question = questions[index];

                        let tr = document.createElement("tr");

                        let id = document.createElement("td");
                        id.append(document.createTextNode(question.id));
                        tr.append(id);

                        let questionName = document.createElement("td");
                        let a1 = document.createElement("a");
                        a1.append(document.createTextNode(question.questionName));
                        a1.setAttribute("href", "/question/showQuestion?id=" + question.id);
                        questionName.append(a1);
                        tr.append(questionName);

                        let questionFrom = document.createElement("td");
                        questionFrom.append(document.createTextNode(question.questionFrom));
                        tr.append(questionFrom);

                        let author = document.createElement("td");
                        author.append(document.createTextNode(question.author));
                        tr.append(author);

                        let tag = document.createElement("td");
                        let a2 = document.createElement("a");
                        a2.append(document.createTextNode(question.tag))
                        a2.setAttribute("class", "ui teal tag label");
                        tag.append(a2);
                        tr.append(tag);

                        let watch = document.createElement("td");
                        watch.append(document.createTextNode(question.watch));
                        tr.append(watch);

                        body.append(tr);
                    }
                }
            })
        }
    })
    //下一页按钮
    $("#nextPage").click(function () {
        let pageNum = $("#pageNum").text();
        let questionNum = $("#questionNum").text();
        //总共页数大小
        let pageMax = (questionNum / 15) | 0;
        if (questionNum % 15 !== 0) {
            pageMax++;
        }

        if (pageNum < pageMax) {
            pageNum++;
            $("#pageNum").text(pageNum);
            $.ajax({
                url: "/question/getPageAllQuestion?page=" + pageNum,
                type: "GET",
                success: function (args) {
                    let questions = JSON.parse(args);
                    let body = $("#body");
                    body.empty();
                    for (let index in questions) {
                        let question = questions[index];

                        let tr = document.createElement("tr");

                        let id = document.createElement("td");
                        id.append(document.createTextNode(question.id));
                        tr.append(id);

                        let questionName = document.createElement("td");
                        let a1 = document.createElement("a");
                        a1.append(document.createTextNode(question.questionName));
                        a1.setAttribute("href", "/question/showQuestion?id=" + question.id);
                        questionName.append(a1);
                        tr.append(questionName);

                        let questionFrom = document.createElement("td");
                        questionFrom.append(document.createTextNode(question.questionFrom));
                        tr.append(questionFrom);

                        let author = document.createElement("td");
                        author.append(document.createTextNode(question.author));
                        tr.append(author);

                        let tag = document.createElement("td");
                        let a2 = document.createElement("a");
                        a2.append(document.createTextNode(question.tag))
                        a2.setAttribute("class", "ui teal tag label");
                        tag.append(a2);
                        tr.append(tag);

                        let watch = document.createElement("td");
                        watch.append(document.createTextNode(question.watch));
                        tr.append(watch);

                        body.append(tr);
                    }
                }
            })
        }
    })
</script>
</body>
</html>